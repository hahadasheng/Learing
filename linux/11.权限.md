# 权限
> Linux的权限造作与用户、用户组是兄弟操作;文件的权限有【**读、写、执行**】

## 一、身份介绍

1. Owner身份
2. Group身份
3. Other身份
4. Root身份

？|读权限|写权限|执行权限|
---|---|---|---|
【文件夹】|列出目录结构|文件夹下创建/删除/复制到/移动到该文档|(无)|
【文件】|查看文件内容|编辑文件内容|针对于二进制可执行文件|

## 二、权限的查看

`ls -l [路径]`简写成`ll`

```
-rw-r--r--. 1 root root 9216 Sep 12  2016 mysql57-community-release-el6-9.noarch.rpm
```
### 各个位置的含义
1. 第一位：
    - `-`:文件
    - `d`:文件夹
    - `l`:软连接
    - `s`:表示套接字
    - 等等
> 下面每个位置只有`-`和位置特定的表示！只有这两种情况！不能交换位置！

2. 第2-4位：文档所有者的权限
    - 第二位`r`: 表示读，如果为`-`，表示没有该权限，
    - 第三位`w`: 写，如果为`-`，表示没有该权限，
    - 第四位`e`: 执行，如果为`-`，表示没有该权限，

3. 第5-7位：属组成员的权限
4. 第8-10：其他成员的权限

## 三、权限设置
> **【root】用户或者【当前文件的所有者】** 才能设置权限；**root用户用户所有文件的所有权限**

### 1.字母形式的权限设置

1. **`chmod 选项 权限的模式 文档`**
    - 【**选项**】: `-R` :对文件夹递归授权，只只针对于文件夹

2. 权限的模式,(***如果同时设置，每组授权用逗号隔开***)
    1. 设置的用户
        1. `u`: 用户
        2. `g`: 组
        3. `o`: 其他
        4. `a`: 所有：如果设置的时候不指定用户，默认给所有用户

    2. 设置作用方式
        1. `+`: 增加权限，性对于当前已有的的权限
        2. `-`: 删除权限，性对于当前已有的的权限
        3. `=`: 确认权限，将权限设置成具体的值

    3. 权限
        1. `r`: 可读
        2. `w`: 可写
        3. `x`: 可执行

4. 栗子：给`nginx`(-rw-------)设置权限:所有者拥有全部权限，组用户拥有可读和执行权限，其他用户只读权限
    - `chmod u+x,g+rx,o+r nginx`
    - 或者：`chmod u=rwx,g=rx,o=r nginx`
    - 还原：`chmod u-x,g-rx,o-r nginx`

### 2.数字形式的权限设置
> 0表示没有任何权限,数字的和就代表着那些属性！

|r|w|x|
---|---|---|
4|2|1|

1. 栗子：给`nginx`(-rw-------)设置权限:所有者拥有全部权限，组用户拥有可读和执行权限，其他用户只读权限
    - `chmod 754 nginx`


## 四、属主与属组设置
> 属主：文件的主人；属组：所属的用户组

```
-rw-r--r--. 1 root root 9913 Jan 13 06:58 install.log

```

> 就是后面两个root位置，代表的就是属主、属组；表示创建者的信息(用户名、用户所属的主组名称)；如果有时候需要删除某个用户，该用户对应的文档属主和属组信息就需要去修改。

### 1.chown
> 更改文档的所属用户
**`chown 用户名 文档路径`**
**`chown -R 用户名 文档路径`**：递归修改
**`chown 用户名:用户组名 文档路径`**：同时更改属主与属组
**`chown -R 用户名:用户组名 文档路径`**

### 2. chgrp(*)
> 更改文档的所属用户组
**`chgrp -R 用户组名 文档路径`**：递归改
**`chgrp 用户组名 文档路径`**：


## 五、sudo(switch user do)
> 【CentOS/Ubuntu支持】reboot/shtudown/init/halt/user管理，普通用户操作不了，有些场合由 指定权限，root可以用 **`sudo`** 命令给相关普通用户进行权限设置

1. Sudo配置文件： `/etc/sudoers`

2. 配置sudo文件需要使用`visudo`命令，(不需要加配置文件名，直接敲即可)

3. 配置普通用户的权限
> 在写sudo规则的时候不建议写直接形式的命令，建议写命令的完整路径。完整路径可以使用which命令来查看`which 指令名称`

```
# root为栗子的描述
root        ALL=(ALL)                ALL
#用户名      允许登录的主机，地址白名单，  当前用户可以执行的命令
#%用户组名    ()内表示的以谁的身份执行     多个命令用英文逗号‘,’分割
#            (ALL)表示root
```

案例
```
# 要求test用户可以在任何主机上以root身份进行添加用户和设置密码操作，
# 但是不能修改root用户的密码
test ALL(ALL) /usr/sbin/useradd,!/usr/bin/passwd root,/usr/bin/passwd
```
